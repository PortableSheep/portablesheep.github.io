!function(t,i,o){function s(s,e){if(this.options=t.extend({},n,e),this.vendors=["Webkit","Moz","O","Ms","Khtml"],this.element=s,this.$window=t(i),this.$document=t(o),this.$body=t(o.body),this.flowTemplate='<div class="flowdialog-flowcontent"><div class="flowdialog-header"><button type="button" class="flowdialog-close" data-dismiss="modal" aria-hidden="true">Ã—</button><h4 class="flowdialog-title"></h4></div><div class="flowdialog-content"></div><div class="flowdialog-footer"></div></div>',this._flow=[],this.flowIndex=0,this.isShowing=!1,this.isFlowing=!1,this.init(),this.options.flow.length>0)for(var h=0,a=this.options.flow.length;h<a;h++)this.initFlow(this.options.flow[h]);this._trigger("onInitComplete")}var e="flowdialog",n={height:"auto",growToHeight:!1,width:600,showCloseButton:!0,closeOnEscape:!1,closeOnOverlayClick:!1,autoOpen:!1,appendTo:o.body,hideEmptyFooter:!0,hideEmptyTitle:!1,useTransitions:!0,animateDuration:250,flow:[]};s.prototype={init:function(){if(void 0===this.$modal){var i=t('<div class="flowdialog-overlay"></div>'),o=t('<div class="flowdialog-container"><div class="flowdialog-modal" tabindex="-1"></div></div>');this.$window.on("resize.flowdialog",t.proxy(this.reposition,this)),this.$window.on("scroll.flowdialog",t.proxy(this.reposition,this)),this.$container=o.appendTo(this.options.appendTo),this.$modal=t("div.flowdialog-modal",this.$container),this.$overlay=i.appendTo(this.$body),this.$modal.on("click","button.flowdialog-close",t.proxy(function(t){t.preventDefault(),this.close()},this)),this.initFlow(this.element),this.refreshOptions(),this.options.autoOpen&&this.open()}},initFlow:function(i){if(i instanceof jQuery&&(i={target:i}),t.isPlainObject(i)&&i.target){for(var o in this.options)"flow"!==o&&(i.hasOwnProperty(o)||(i[o]=this.options[o]));var s=t(this.flowTemplate).appendTo(this.$modal);i._$header=t("div.flowdialog-header",s),i._$btnClose=t("button.flowdialog-close",i._$header),i._$title=t("h4.flowdialog-title",s).html(i.target.attr("title")||""),i._$content=t("div.flowdialog-content",s),i._$footer=t("div.flowdialog-footer",s);var e=i.target.find('div[data-type="footer"]:first');e.length>0?e.detach().unwrap().appendTo(i._$footer):i.hideEmptyFooter&&i._$footer.hide(),i.target.appendTo(i._$content).show(0),i.target=s,this._flow.push(i)}},open:function(i){if(void 0!==i&&this._flow.length>=i&&null!==this._flow[i]&&(this.flowIndex=i),this.$body.addClass("flowdialog-modalopen"),this.refreshOptions(),this.options.useTransitions){var o=this.$overlay.css("opacity"),s=this.$modal.css("top");this.$overlay.css("opacity",0).show(0).animate({opacity:o},this.options.animateDuration,t.proxy(function(){this.$container.show(0),this._flow[this.flowIndex].target.show(0).animate({opacity:1},this.options.animateDuration),this.$modal.css({top:"-30%",opacity:0}).show(0).animate({top:s,opacity:1},this.options.animateDuration)},this))}else this.$overlay.show(),this.$container.show(),this._flow[this.flowIndex].target.show(0).css("opacity","1"),this.$modal.show();setTimeout(t.proxy(function(){this.$modal.focus()},this),this.options.transitionDelay),this.isShowing=!0,this._trigger("onOpen")},close:function(){if(this._trigger("onPreClose")){var i=t.Deferred();this.options.useTransitions?this.$modal.animate({top:"-30%",opacity:0},this.options.animateDuration,t.proxy(function(){this.$modal.hide(0).css({top:"",opacity:""}),this.$container.hide(0),this.$overlay.animate({opacity:0},this.options.animateDuration,t.proxy(function(){this.$overlay.hide(0).css("opacity",""),this.$body.removeClass("flowdialog-modalopen"),i.resolve()},this))},this)):(this.$modal.hide(),this.$container.hide(),this.$overlay.hide(),this.$body.removeClass("flowdialog-modalopen"),i.resolve()),i.done(t.proxy(function(){this.flowIndex=0;for(var t=0,i=this._flow.length;t<i;t++)this._flow[t].target.hide(0).css("opacity","");this.isShowing=!1,this._trigger("onClose")},this))}},option:function(i,o){if(void 0===i&&void 0===o||"target"===i&&void 0!==o)return this.element;if(t.isPlainObject(i)&&void 0===o)for(var s in i)this._flow[this.flowIndex][s]!==i[s]&&(this._flow[this.flowIndex][s]=i[s]);else{if(void 0===i||void 0===o)return this._flow[this.flowIndex][i];this._flow[this.flowIndex][i]!==o&&(this._flow[this.flowIndex][i]=o)}this.refreshOptions()},refreshOptions:function(i){var o=this._flow[this.flowIndex],s={height:o.growToHeight&&"auto"!==o.height?"auto":o.height,"max-height":o.growToHeight&&"auto"!==o.height?o.height:""};this.reposition(),i?o._$content.css(s):this.options.useTransitions&&this.isShowing?(o.growToHeight||o._$content.css("max-height",""),o._$content.animate(s,this.options.animateDuration)):o._$content.css(s),"auto"!==o.height?o._$content.addClass("flowdialog-overflow"):o._$content.removeClass("flowdialog-overflow"),o.showCloseButton?(o._$btnClose.show(),o._$header.show()):o._$btnClose.hide(),o.hideEmptyTitle&&0===t.trim(o._$title.text()).length&&!o.showCloseButton?o._$header.hide():o._$header.show(),o.closeOnEscape?(this.$document.off("keyup.flowdialog"),this.$document.on("keyup.flowdialog",function(t){27===(t.which||t.keyCode)&&this.close()}.bind(this))):this.$document.off("keyup.flowdialog"),o.closeOnOverlayClick?(this.$container.off("click.flowdialog"),this.$container.on("click.flowdialog",function(){this.close()}.bind(this))):this.$container.off("click.flowdialog")},reposition:function(){var t={width:i.scrollWidth,height:this.$window.height()};this.$overlay.css(t),this.$container.css(t);var o=this._flow[this.flowIndex].width,s=(this.$container.width()-o)/2+this.$window.scrollLeft();this.isShowing&&this.options.useTransitions?this.options.useTransitions&&this.$modal.css("left",s).animate({width:o},this.options.animateDuration):this.$modal.css({width:o,left:s}),this._trigger("onReposition")},flowTo:function(i){var o=t.Deferred();if(this._flow.length>1&&i<=this._flow.length-1&&i>=0){var s=this._flow[this.flowIndex],e=this._flow[i];if(this.isFlowing=!0,this.options.useTransitions){var n;("auto"===e.height||e.growToHeight)&&(e.target.css({position:"absolute",left:"-9999px",visible:"hidden",display:"block",width:e.width}),e._$content.css("height","auto"),n=e._$content.outerHeight(),e.target.css({position:"",left:"",visible:"",display:""})),this.$modal.css("overflow","hidden"),s.target.animate({opacity:0},this.options.animateDuration,t.proxy(function(){e._$content.css({height:s._$content.css("height"),"max-height":""}),e.target.show(0),s.target.hide(0),e._$content.animate({height:n||e.height},this.options.animateDuration),this.$modal.animate({width:e.width,left:(this.$container.width()-e.width)/2+this.$window.scrollLeft()},this.options.animateDuration,t.proxy(function(){this.flowIndex=i,this.refreshOptions(!0),this.$modal.css("overflow",""),e.target.animate({opacity:1},this.options.animateDuration),this.isFlowing=!1,o.resolve()},this))},this))}else s.target.hide(),this.flowIndex=i,this.refreshOptions(),e.target.css("opacity","1").show(),this.isFlowing=!1,o.resolve()}else o.reject();return o.promise()},flow:function(i,o){if("next"===i)this.flowTo(this.flowIndex+1).done(t.proxy(function(){this._trigger("onFlow")},this));else if("prev"===i)this.flowTo(this.flowIndex-1).done(t.proxy(function(){this._trigger("onFlow")},this));else if("index"===i){if(void 0===o)return this.flowIndex;o!==this.flowIndex&&this.flowTo(o).done(t.proxy(function(){this._trigger("onFlow")},this))}},_trigger:function(i){var o=t.Event(e+"_"+i);return this.element.triggerHandler(o,[this]),o.isDefaultPrevented()===!1}},t.fn[e]=function(i){var o=t.isPlainObject(i)?i:{},n=t.data(this,"plugin_"+e);if(n){if("string"==typeof i&&n[i]&&t.isFunction(n[i])){var h=arguments.length>=2?Array.prototype.slice.call(arguments,1):[],a=n[i].apply(n,h);return void 0===a?this:a}return this}return n=new s(this,o),t.data(this,"plugin_"+e,n),this}}(jQuery,window,document);